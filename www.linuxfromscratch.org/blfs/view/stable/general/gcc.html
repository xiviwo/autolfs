<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content=
    "application/xhtml+xml; charset=iso-8859-1" />
    <title>
      GCC-4.9.1
    </title>
    <link rel="stylesheet" href="../stylesheets/lfs.css" type="text/css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.73.2" />
    <link rel="stylesheet" href="../stylesheets/lfs-print.css" type=
    "text/css" media="print" />
  </head>
  <body class="blfs" id="blfs-7.6">
    <div class="navheader">
      <h4>
        Beyond Linux<sup>®</sup> From Scratch - Version 7.6
      </h4>
      <h3>
        Chapter&nbsp;13.&nbsp;Programming
      </h3>
      <ul>
        <li class="prev">
          <a accesskey="p" href="expect.html" title="Expect-5.45">Prev</a>
          <p>
            Expect-5.45
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="gcc-ada.html" title="GCC-Ada-4.9.1">Next</a>
          <p>
            GCC-Ada-4.9.1
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="prog.html" title=
          "Chapter&nbsp;13.&nbsp;Programming">Up</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Beyond Linux® From Scratch - Version 7.6">Home</a>
        </li>
      </ul>
    </div>
    <div class="sect1" lang="en" xml:lang="en">
      <h1 class="sect1">
        <a id="gcc" name="gcc"></a>GCC-4.9.1
      </h1>
      <div class="package" lang="en" xml:lang="en">
        <h2 class="sect2">
          Introduction to GCC
        </h2>
        <p>
          The <span class="application">GCC</span> package contains the GNU
          Compiler Collection. This page describes the installation of
          compilers for the following languages: C, C++, Fortran, Objective
          C, Objective C++, and Go. Two additional languages , Ada and Java
          are available in the collection. They have specific requirements,
          so they are described in separate pages (<a class="xref" href=
          "gcc-ada.html" title="GCC-Ada-4.9.1">GCC-Ada-4.9.1</a> and
          <a class="xref" href="gcc-java.html" title=
          "GCC-Java-4.9.1">GCC-Java-4.9.1</a>). Since C and C++ are installed
          in LFS, this page is either for upgrading C and C++, or for
          installing additional compilers.
        </p>
        <p>
          This package is known to build and work properly using an LFS-7.6
          platform.
        </p>
        <div class="admon caution">
          <img alt="[Caution]" src="../images/caution.png" />
          <h3>
            Caution
          </h3>
          <p>
            If you are upgrading <span class="application">GCC</span> from
            any other version prior to 4.9.1, then you must be careful
            compiling 3rd party kernel modules. You should ensure that the
            kernel and all its native modules are also compiled using the
            same version of <span class="application">GCC</span> that you use
            to build the 3rd party module. This issue does not affect native
            kernel (and kernel modules) updates, as the instructions below
            are a complete reinstallation of <span class=
            "application">GCC</span>. If you have existing 3rd party modules
            installed, ensure they are recompiled using the updated version
            of <span class="application">GCC</span>. As always, never update
            the kernel headers from the ones used when <span class=
            "application">Glibc</span> was compiled during LFS.
          </p>
        </div>
        <h3>
          Package Information
        </h3>
        <div class="itemizedlist">
          <ul class="compact">
            <li>
              <p>
                Download (HTTP): <a class="ulink" href=
                "http://ftp.gnu.org/gnu/gcc/gcc-4.9.1/gcc-4.9.1.tar.bz2">http://ftp.gnu.org/gnu/gcc/gcc-4.9.1/gcc-4.9.1.tar.bz2</a>
              </p>
            </li>
            <li>
              <p>
                Download (FTP): <a class="ulink" href=
                "ftp://ftp.gnu.org/gnu/gcc/gcc-4.9.1/gcc-4.9.1.tar.bz2">ftp://ftp.gnu.org/gnu/gcc/gcc-4.9.1/gcc-4.9.1.tar.bz2</a>
              </p>
            </li>
            <li>
              <p>
                Download MD5 sum: fddf71348546af523353bd43d34919c1
              </p>
            </li>
            <li>
              <p>
                Download size: 86 MB
              </p>
            </li>
            <li>
              <p>
                Estimated disk space required: 5.1 GB
              </p>
            </li>
            <li>
              <p>
                Estimated build time: 145 SBU
              </p>
            </li>
          </ul>
        </div>
        <h3>
          Additional Downloads
        </h3>
        <div class="itemizedlist">
          <ul class="compact">
            <li>
              <p>
                Required patch: <a class="ulink" href=
                "http://www.linuxfromscratch.org/patches/blfs/7.6/gcc-4.9.1-upstream_fixes-1.patch">
                http://www.linuxfromscratch.org/patches/blfs/7.6/gcc-4.9.1-upstream_fixes-1.patch</a>
              </p>
            </li>
          </ul>
        </div>
        <h3>
          GCC Dependencies
        </h3>
        <h4>
          Recommended
        </h4>
        <p class="recommended">
          <a class="xref" href="dejagnu.html" title=
          "DejaGnu-1.5.1">DejaGnu-1.5.1</a>, for tests
        </p>
        <p class="usernotes">
          User Notes: <a class="ulink" href=
          "http://wiki.linuxfromscratch.org/blfs/wiki/gcc">http://wiki.linuxfromscratch.org/blfs/wiki/gcc</a>
        </p>
      </div>
      <div class="installation" lang="en" xml:lang="en">
        <h2 class="sect2">
          Installation of GCC
        </h2>
        <div class="admon important">
          <img alt="[Important]" src="../images/important.png" />
          <h3>
            Important
          </h3>
          <p>
            Even if you specify only languages other than C and C++ to the
            <span class="command"><strong>./configure</strong></span> command
            below, the installation process will overwrite your existing
            <span class="application">GCC</span> C and C++ compilers and
            libraries. Having the <span class="application">Tcl</span>,
            <span class="application">Expect</span> and <span class=
            "application">DejaGnu</span> packages installed before beginning
            the build is highly recommended so you can run the full suite of
            tests.
          </p>
          <p>
            Do not continue with the <span class="command"><strong>make
            install</strong></span> command until you are confident the build
            was successful. You can compare your test results with those
            found at <a class="ulink" href=
            "http://gcc.gnu.org/ml/gcc-testresults/">http://gcc.gnu.org/ml/gcc-testresults/</a>.
            You may also want to refer to the information found in the
            <span class="application">GCC</span> section of Chapter 6 in the
            LFS book (<a class="ulink" href=
            "http://www.linuxfromscratch.org/lfs/view/7.6/chapter06/gcc.html">../../../../lfs/view/7.6/chapter06/gcc.html</a>).
          </p>
        </div>
        <p>
          The instructions below are intentionally performing a
          &ldquo;<span class="quote">bootstrap</span>&rdquo; process.
          Bootstrapping is needed for robustness and is highly recommended
          when upgrading the compilers version. To disable bootstrap anyways,
          add <em class="parameter"><code>--disable-bootstrap</code></em> to
          the <span class="command"><strong>./configure</strong></span>
          options below.
        </p>
        <p>
          As in LFS, fix a problem identified upstream:
        </p>
        <pre class="userinput">
<kbd class=
"command">sed -i 's/if \((code.*))\)/if (\1 \&amp;\&amp; \!DEBUG_INSN_P (insn))/' gcc/sched-deps.c</kbd>
</pre>
        <p>
          Install <span class="application">GCC</span> by running the
          following commands:
        </p>
        <pre class="userinput">
<kbd class=
"command">patch -Np1 -i ../gcc-4.9.1-upstream_fixes-1.patch    &amp;&amp;
mkdir ../gcc-build                                   &amp;&amp;
cd    ../gcc-build                                   &amp;&amp;

../gcc-4.9.1/configure                               \
    --prefix=/usr                                    \
    --libdir=/usr/lib                                \
    --enable-shared                                  \
    --enable-threads=posix                           \
    --enable-__cxa_atexit                            \
    --enable-clocale=gnu                             \
    --disable-multilib                               \
    --with-system-zlib                               \
    --enable-languages=c,c++,fortran,go,objc,obj-c++ &amp;&amp;
make</kbd>
</pre>
        <p>
          If you have installed additional packages such as <span class=
          "application">Valgrind</span> and <span class=
          "application">GDB</span>, the <span class="application">GCC</span>
          part of the testsuite will run more tests than in LFS. Some of
          those will report FAIL and others XPASS (pass when expected to
          FAIL). To run the tests, issue:
        </p>
        <pre class="userinput">
<kbd class="command">ulimit -s 32768 &amp;&amp;
make -k check</kbd>
</pre>
        <p>
          The tests are very long, and the results may be hard to find in the
          logs, specially if you use parallel jobs with make. You can get a
          summary of the tests with:
        </p>
        <pre class="userinput">
<kbd class="command">../gcc-4.9.1/contrib/test_summary</kbd>
</pre>
        <p>
          Now, as the <code class="systemitem">root</code> user:
        </p>
        <pre class="root">
<kbd class="command">make install &amp;&amp;

mkdir -pv /usr/share/gdb/auto-load/usr/lib              &amp;&amp;
mv -v /usr/lib/*gdb.py /usr/share/gdb/auto-load/usr/lib &amp;&amp;

chown -v -R root:root \
    /usr/lib/gcc/*linux-gnu/4.9.1/include{,-fixed}</kbd>
</pre>
        <p>
          Some packages expect to find the C preprocessor in <code class=
          "filename">/lib</code> or may refer to the C compiler under the
          name <span class="command"><strong>cc</strong></span>. The
          following symbolic links are not needed if you have followed the
          LFS instructions, since they have been already created. If you do
          not have them on your system, issue as the <code class=
          "systemitem">root</code> user:
        </p>
        <pre class="root">
<kbd class="command">ln -v -sf ../usr/bin/cpp /lib &amp;&amp;
ln -v -sf gcc /usr/bin/cc</kbd>
</pre>
      </div>
      <div class="commands" lang="en" xml:lang="en">
        <h2 class="sect2">
          Command Explanations
        </h2>
        <p>
          <span class="command"><strong>patch ...
          gcc-4.9.1-upstream_fixes-1.patch</strong></span>: This patch
          corrects bugs in the C++ compiler, which lead to segmentation
          faults in some cases.
        </p>
        <p>
          <span class="command"><strong>mkdir ../gcc-build; cd
          ../gcc-build</strong></span>: The <span class=
          "application">GCC</span> documentation recommends building the
          package in a dedicated build directory.
        </p>
        <p>
          <em class="parameter"><code>--enable-shared --enable-threads=posix
          --enable-__cxa_atexit</code></em>: These parameters are required to
          build the <span class="application">C++</span> libraries to
          published standards.
        </p>
        <p>
          <em class="parameter"><code>--enable-clocale=gnu</code></em>: This
          parameter is a failsafe for incomplete locale data.
        </p>
        <p>
          <em class="parameter"><code>--disable-multilib</code></em>: This
          parameter ensures that files are created for the specific
          architecture of your computer.
        </p>
        <p>
          <em class="parameter"><code>--with-system-zlib</code></em>: Uses
          the system <span class="application">zlib</span> instead of the
          bundled one. <span class="application">zlib</span> is used for
          compressing and uncompressing <span class=
          "application">GCC</span>'s intermediate language in LTO (Link Time
          Optimization) object files.
        </p>
        <p>
          <em class=
          "parameter"><code>--enable-languages=c,c++,fortran,go,objc,obj-c++</code></em>:
          This command identifies which languages to build. You may modify
          this command to remove undesired languages.
        </p>
        <p>
          <span class="command"><strong>ulimit -s 32768</strong></span>: This
          command prevents several tests from running out of stack space.
        </p>
        <p>
          <span class="command"><strong>make -k check</strong></span>: This
          command runs the test suite without stopping if any errors are
          encountered.
        </p>
        <p>
          <span class=
          "command"><strong>../gcc-4.9.1/contrib/test_summary</strong></span>:
          This command will produce a summary of the test suite results. You
          can append <span class="command"><strong>| grep -A7
          Summ</strong></span> to the command to produce an even more
          condensed version of the summary. You may also wish to redirect the
          output to a file for review and comparison later on.
        </p>
        <p>
          <span class="command"><strong>mv -v /usr/lib/*gdb.py
          ...</strong></span>: The installation stage puts some files used by
          <span class="application">gdb</span> under the <code class=
          "filename">/usr/lib</code> directory. This generates spurious error
          messages when performing <span class=
          "command"><strong>ldconfig</strong></span>. This command moves the
          files to another location.
        </p>
        <p>
          <span class="command"><strong>chown -v -R root:root
          /usr/lib/gcc/*linux-gnu/...</strong></span>: If the package is
          built by a user other than root, the ownership of the installed
          <code class="filename">include</code> directory (and its content)
          will be incorrect. This command changes the ownership to the
          <code class="systemitem">root</code> user and group.
        </p>
      </div>
      <div class="content" lang="en" xml:lang="en">
        <h2 class="sect2">
          Contents
        </h2>
        <p>
          Some program and library names and descriptions are not listed
          here, but can be found at <a class="ulink" href=
          "http://www.linuxfromscratch.org/lfs/view/7.6/chapter06/gcc.html#contents-gcc">../../../../lfs/view/7.6/chapter06/gcc.html#contents-gcc</a>
          as they were initially installed during the building of LFS.
        </p>
        <div class="segmentedlist">
          <div class="seglistitem">
            <div class="seg">
              <strong class="segtitle">Installed Programs:</strong>
              <span class="segbody">gccgo and gfortran, hard-linked to
              architecture specific names</span>
            </div>
            <div class="seg">
              <strong class="segtitle">Installed Libraries:</strong>
              <span class="segbody">libgfortran.{so,a}, libgo.{so,a},
              libgobegin.a, libobjc.{so,a}, and numerous other run-time
              libraries and executables in <code class=
              "filename">/usr/lib/gcc</code> and <code class=
              "filename">/usr/libexec/gcc</code></span>
            </div>
            <div class="seg">
              <strong class="segtitle">Installed Directories:</strong>
              <span class=
              "segbody">/usr/lib/gcc/&lt;arch-triplet&gt;/4.9.1/include/objc
              and /usr/lib/go</span>
            </div>
          </div>
        </div>
        <div class="variablelist">
          <h3>
            Short Descriptions
          </h3>
          <table border="0">
            <col align="left" valign="top" />
            <tbody>
              <tr>
                <td>
                  <p>
                    <a id="gccgo" name="gccgo"></a><span class=
                    "term"><span class=
                    "command"><strong>gccgo</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    is a GCC-based compiler for the <span class=
                    "application">Go</span> language.
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="gfortran" name="gfortran"></a><span class=
                    "term"><span class=
                    "command"><strong>gfortran</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    is a GCC-based compiler for the <span class=
                    "application">Fortran</span> language.
                  </p>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <p class="updated">
        Last updated on 2014-09-17 04:10:41 -0700
      </p>
    </div>
    <div class="navfooter">
      <ul>
        <li class="prev">
          <a accesskey="p" href="expect.html" title="Expect-5.45">Prev</a>
          <p>
            Expect-5.45
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="gcc-ada.html" title="GCC-Ada-4.9.1">Next</a>
          <p>
            GCC-Ada-4.9.1
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="prog.html" title=
          "Chapter&nbsp;13.&nbsp;Programming">Up</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Beyond Linux® From Scratch - Version 7.6">Home</a>
        </li>
      </ul>
    </div>
  </body>
</html>
